# amps-helm

### Usage Instructions:

1. Run "helm dependency update" to fetch all dependency charts. 
2. Inside this repository is a file named values.yaml. You can leave much of the configuration in that file as is, however it will be important for you to update a few sections so the charts runs locally on your machine.  
    - For the nodeHost configuration, you must specify the hostname of the node on which you will be deploying amps. You can see this information under the "NAME" field after running "kubectl get node".
    - Under the ports section of the configuration, if you intend to expose additional ports for additional services, you must add them under the ports configuration with the same format as the already specified AMPS Port and sftp port 15022 which has been added for your convenience. 
    - For the temp directory and modules directory configuration, if you wish to change the tempMount and moduleMount, set those values accordingly to where on the container you want persistent volumes to be mounted. Additionally set the tempSize and moduleSize to the sizes you want these volumes to be. (NOTE: When performing AMPS Application Startup, ensure that the paths provided for storage temp and module path correspond to tempMount and moduleMount. If you leave the mounts as is, you will not need to change the default paths.)
3. After making relevant changes to the configuration as mentioned above, you should now be able to leave the remaining configuration as is and run the chart. From a command line, run "helm install amps ." in the root of the repository. The chart should install and you should see a note telling you where to access both the Admin and User portals. It will take a few minutes to start all dependencies and containers. To confirm a successful install, run "kubectl get pod -o wide" after a few minutes and you should see all containers running. You should now be able to navigate to both portals as specified earlier.
4. If you begin to encouter odd errors and wish to start fresh, you can run "helm uninstall amps" to uninstall the chart, "kubectl delete pvc --all" to delete all persistent volume claims, "kubectl delete pv --all" to delete all persistent volumes, and "kubectl delete all --all" to clear up all other resources.